(()=>{"use strict";let e;var r,t,o={};o.d=(e,r)=>{for(var t in r)o.o(r,t)&&!o.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:r[t]})},o.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),o.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var n={};o.r(n),o.d(n,{createHeadless:()=>ej,showVaultManager:()=>eG,showUniversalCheckout:()=>eB,SDK_VERSION:()=>eL,preloadPrimer:()=>eF});let a=()=>c.randomUUID?.()||i(),i=()=>"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^s()>>e/4).toString(16)),s=()=>(c.getRandomValues?.(new Uint8Array(1))[0]??16*Math.random())&15,c="undefined"!=typeof crypto?crypto:{},l="2.4";class d extends Error{static from(e,r=!1){if(e instanceof d)return e;let t=new d(e instanceof Error?e.message:String(e),r);return e instanceof Error&&e.stack&&(t.stack=e.stack,Object.assign(t,e)),t}markAsReported(){this.isReported=!0}constructor(e,r=!1){var t,o;super(e),o=void 0,(t="isReported")in this?Object.defineProperty(this,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):this[t]=o,this.isReported=r,this.name=this.constructor.name,Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}let u="https://analytics.production.data.primer.io/sdk-logs";var p=((h={}).REQUEST_START="REQUEST_START",h.REQUEST_END="REQUEST_END",h),m=((E={}).START="START",E.END="END",E);let f={createHeadless:"HEADLESS_LOADING",showUniversalCheckout:"DROP_IN_LOADING",showVaultManager:"VAULT_MANAGER_LOADING",preloadPrimer:"PRELOAD_PRIMER_LOADING"};var h,E,y,w,S=((y={}).NETWORK_CALL_EVENT="NETWORK_CALL_EVENT",y.CRASH_EVENT="CRASH_EVENT",y.TIMER_EVENT="TIMER_EVENT",y.MESSAGE_EVENT="MESSAGE_EVENT",y.SCRIPT_UNAUTHORIZED_EVENT="SCRIPT_UNAUTHORIZED_EVENT",y.V1_EVENT="V1_EVENT",y.SDK_FUNCTION_EVENT="SDK_FUNCTION_EVENT",y),g=((w=g||{}).CHARGING="CHARGING",w.NOT_CHARGING="NOT_CHARGING",w);async function T(){if("undefined"==typeof navigator||"undefined"==typeof performance)return;let e=await navigator.getBattery?.();return{memoryFootprint:performance.memory?.usedJSHeapSize,screen:{height:screen?.height,width:screen?.width},userAgent:navigator.userAgent,locale:navigator.language,batteryLevel:e?.level,batteryStatus:e?.charging?"CHARGING":"NOT_CHARGING"}}let R=({get(e,r){let t;try{switch(e){case"PRIMER_SDK_VERSION":t="v2.57.3";break;case"PRIMER_ASSETS_URL":t=process.env.PRIMER_ASSETS_URL;break;case"PRIMER_BUILD_INTEGRATION_BUILDER":t=process.env.PRIMER_BUILD_INTEGRATION_BUILDER}}catch{}return t||r}}).get("PRIMER_SDK_VERSION");async function v(e,r,t){return{...t,createdAt:Date.now(),device:await T(),eventType:e,properties:r,sdkVersion:R,sdkType:"WEB"}}let N=Symbol.for("__primerAnalytics__"),k={providers:new Map,timers:new Map,eventsQueue:new Map};if("undefined"!=typeof window){let e=window[N];e?k=e:window[N]=k}let A=()=>k.providers,_=()=>k.timers,b=()=>k.eventsQueue,I=new Map;function C(e,r=!1,t=1){I.has(e)&&(clearTimeout(I.get(e)),I.delete(e));let o=()=>{let o=b().get(e);if(o?.length){let n=!0,a=[],i=0,s=0;for(;s<o.length;){let r=o[s],t=new Blob([JSON.stringify(r)]).size;if(t>64e3){console.error("Event size exceeds maximum payload size and will be skipped:",r),s++;continue}if(i+t>64e3&&a.length>0){try{n=navigator.sendBeacon(e,JSON.stringify(a))}catch(e){n=!1,console.error("Unable to send events",e)}if(!n)break;a=[],i=0}a.push(r),i+=t,s++}if(a.length>0&&n)try{n=navigator.sendBeacon(e,JSON.stringify(a))}catch(e){n=!1,console.error("Unable to send events",e)}n?b().delete(e):t<5?setTimeout(()=>C(e,r,t+1),500*Math.pow(2,t)):console.error("Max retry attempts reached. Events will not be sent.")}};if(r)return void o();let n=setTimeout(o,500);I.set(e,n)}let O=!1;function P({url:e=u,...r}){"undefined"==typeof document||O||(document.addEventListener("visibilitychange",()=>{if("hidden"===document.visibilityState){let e=D(r.checkoutSessionId);e.messageEvent({messageType:"VISIBILITY_CHANGE",message:"Checkout visibility is hidden (tab or window change, redirect or being closed)."}),C(e.url,!0)}}),O=!0);let t=t=>async o=>{var n;let a;"undefined"!=typeof navigator&&(n=function e(r,t,o=new WeakSet,n=0,a=10){if(n>a||o.has(r))return r;o.add(r);let i=r=>"object"==typeof r&&null!==r?e(r,t,o,n+1,a):t(r);return Array.isArray(r)?r.map(i):Object.fromEntries(Object.entries(r).map(([e,r])=>[e,i(r)]))}(await v(t,o,r),e=>{var r;return"string"==typeof(r="function"==typeof e?e.name||"function":e)&&r.length>5120?`${r.slice(0,5120)}...`:r}),b().has(e)||b().set(e,[]),a=b().get(e),a?.push(n),C(e))},o={crashEvent:t(S.CRASH_EVENT),messageEvent:t(S.MESSAGE_EVENT),networkCallEvent:t(S.NETWORK_CALL_EVENT),scriptUnauthorizedEvent:t(S.SCRIPT_UNAUTHORIZED_EVENT),sdkFunctionEvent:t(S.SDK_FUNCTION_EVENT),timerStart:({id:e,...o})=>{let n=`${r.checkoutSessionId}|${e}`,a=performance?.now?performance.now():Date.now();return _().set(n,{start:a}),t(S.TIMER_EVENT)({...o,id:e,timerType:m.START})},timerEnd:({id:e,...o})=>{let n=`${r.checkoutSessionId}|${e}`,{start:a}=_().get(n)??{};_().delete(n);let i=performance?.now?performance.now():Date.now();return t(S.TIMER_EVENT)({...o,id:e,timerType:m.END,duration:a?i-a:void 0})},v1Event:t(S.V1_EVENT),url:e};return A().set(r.checkoutSessionId,o),D(r.checkoutSessionId)}function D(e){return new Proxy({},{get:(r,t)=>(A().get(e)??P({checkoutSessionId:e}))[t]})}let U=(e,r,t,o)=>({callType:t?p.REQUEST_END:p.REQUEST_START,id:e,errorBody:t?.error&&JSON.stringify(t.error,Object.getOwnPropertyNames(t.error)),method:r.method,responseCode:t?.status,url:r.url,duration:o});function x(e){return e?new Promise(r=>{setTimeout(r,e)}):Promise.resolve()}async function V(e,r,t,o=x){let n=0,a={enabled:r?.enabled??!1,maxRetries:8,initialBackoff:100,retryNetworkErrors:!0,retry500Errors:!1,maxJitter:100};if(!a.enabled)return e();for(;;)try{let r=await e();if(n){let e=`Request succeeded after ${n} retries.`;"object"==typeof r&&r&&"status"in r&&(e+=` Status code: ${r.status}`),t?.({messageType:"RETRY_SUCCESS",message:e,severity:"INFO"})}return r}catch(l){let e=n>=a.maxRetries,r=l.isNetworkError&&!a.retryNetworkErrors,i=l.status&&l.status>=500&&!a.retry500Errors;if(e||r||i){let o=`Failed after ${n} retries. `;throw e?o+=`Reached maximum retries (${a.maxRetries}).`:r?o+="Network error encountered and retryNetworkErrors is disabled.":i&&(o+="HTTP 500 error encountered and retry500Errors is disabled."),o+=` Last error: ${l.message}`,t?.({messageType:"RETRY_FAILED",message:o,severity:"ERROR",errorBody:JSON.stringify(l,Object.getOwnPropertyNames(l))}),Error(o,{cause:l})}n++;let s=Math.min(a.initialBackoff*Math.pow(2,n-1)+Math.random()*a.maxJitter,Number.MAX_SAFE_INTEGER),c="Unknown error";l.isNetworkError?c="Network error":l.status&&(c=`HTTP ${l.status} error`),t?.({messageType:"RETRY",message:`Retry attempt ${n}/${a.maxRetries} due to: ${c}. Error details: ${l.message}. Waiting for ${s.toFixed(2)}ms before next attempt.`,severity:"WARN",errorBody:JSON.stringify(l,Object.getOwnPropertyNames(l))}),await o(s)}}let M={cache:new Map};"undefined"!=typeof window&&((r=window)[t="__primerCache__"]??(r[t]=M),M=window.__primerCache__);let $=()=>M.cache;function F(){if($().size<=30)return;let e=Date.now();for(let[r,t]of $())t.exp<e&&$().delete(r);if($().size>50)for(let[e]of $()){if($().size<=50)break;$().delete(e)}}let L=(e,r,t)=>j(e,"get",r,t),j=async(e,r,t,o,n)=>{let i=a(),s=performance?.now(),c=D(e),l={method:r,url:t,body:n};c.networkCallEvent(U(i,l));try{let a=await fetch(t,{body:n,method:r,headers:{"content-type":"application/json","x-request-id":i,...o}});if(!a.ok){let e=Error(`HTTP error! status: ${a.status}`);throw e.status=a.status,e}let d=await a.json();if(t.includes("client-sdk/configuration")){let{primerAccountId:r,clientSession:{clientSessionId:t,customer:o}}=d;c=P({checkoutSessionId:e,clientSessionId:t,customerId:o?.customerId,primerAccountId:r,url:c.url})}let u=performance?.now();return c.networkCallEvent(U(i,l,{data:d},u-s)),{data:d,headers:a.headers,status:a.status,source:"NETWORK"}}catch(r){let e=performance?.now();throw Object.assign(r,{isNetworkError:r instanceof TypeError}),c.networkCallEvent(U(i,l,{error:r},e-s)),r}},B=(e,r)=>new Promise((t,o)=>{let n=setTimeout(()=>{let e=Error("Request timed out");e.isNetworkError=!0,o(e)},r);e.then(t).catch(o).finally(()=>clearTimeout(n))}),G=(e,r)=>{let{headers:t,retryConfig:o,cacheConfig:n,timeout:a=15e3,checkoutSessionId:i}=r,s=D(i);return(function(e){if(!e)return e=>e();let{key:r,refresh:t=!1,usePrimerSessionCacheTtlHeader:o=!1,ttl:n=36e5}=e;return async e=>{let a=Date.now(),i=$().get(r);if(!t&&i&&i.exp>a)return i.promise;i&&$().delete(r);let s=e().then(e=>{let t=n;return o&&(t=1e3*(Number(e.headers.get("x-primer-session-cache-ttl"))||0)),function({key:e,ttl:r=36e5},t){r?$().set(e,{promise:Promise.resolve({...t,source:"CACHE"}),exp:Date.now()+r}):$().delete(e)}({key:r,ttl:t},e),F(),e},e=>{throw $().delete(r),e});return $().set(r,{promise:s,exp:a+n}),F(),s}})(n)(()=>V(()=>B(L(i,e,t),a),o,r=>s.messageEvent({...r,url:e})))},H="function"==typeof Buffer,z="function"==typeof TextDecoder?new TextDecoder:void 0,K="function"==typeof TextEncoder?new TextEncoder:void 0,J=Array.prototype.slice.call("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="),W=(e=>{let r={};return e.forEach((e,t)=>r[e]=t),r})(J),Q=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,Z=String.fromCharCode.bind(String),q="function"==typeof Uint8Array.from?Uint8Array.from.bind(Uint8Array):e=>new Uint8Array(Array.prototype.slice.call(e,0)),Y=e=>e.replace(/=/g,"").replace(/[+\/]/g,e=>"+"==e?"-":"_"),X=e=>e.replace(/[^A-Za-z0-9\+\/]/g,""),ee="function"==typeof btoa?e=>btoa(e):H?e=>Buffer.from(e,"binary").toString("base64"):e=>{let r,t,o,n,a="",i=e.length%3;for(let i=0;i<e.length;){if((t=e.charCodeAt(i++))>255||(o=e.charCodeAt(i++))>255||(n=e.charCodeAt(i++))>255)throw TypeError("invalid character found");a+=J[(r=t<<16|o<<8|n)>>18&63]+J[r>>12&63]+J[r>>6&63]+J[63&r]}return i?a.slice(0,i-3)+"===".substring(i):a},er=H?e=>Buffer.from(e).toString("base64"):e=>{let r=[];for(let t=0,o=e.length;t<o;t+=4096)r.push(Z.apply(null,e.subarray(t,t+4096)));return ee(r.join(""))},et=(e,r=!1)=>r?Y(er(e)):er(e),eo=e=>{if(e.length<2){var r=e.charCodeAt(0);return r<128?e:r<2048?Z(192|r>>>6)+Z(128|63&r):Z(224|r>>>12&15)+Z(128|r>>>6&63)+Z(128|63&r)}var r=65536+(e.charCodeAt(0)-55296)*1024+(e.charCodeAt(1)-56320);return Z(240|r>>>18&7)+Z(128|r>>>12&63)+Z(128|r>>>6&63)+Z(128|63&r)},en=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,ea=e=>e.replace(en,eo),ei=H?e=>Buffer.from(e,"utf8").toString("base64"):K?e=>er(K.encode(e)):e=>ee(ea(e)),es=(e,r=!1)=>r?Y(ei(e)):ei(e),ec=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,el=e=>{switch(e.length){case 4:var r=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return Z((r>>>10)+55296)+Z((1023&r)+56320);case 3:return Z((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return Z((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},ed=e=>e.replace(ec,el),eu="function"==typeof atob?e=>atob(X(e)):H?e=>Buffer.from(e,"base64").toString("binary"):e=>{if(e=e.replace(/\s+/g,""),!Q.test(e))throw TypeError("malformed base64.");e+="==".slice(2-(3&e.length));let r,t="",o,n;for(let a=0;a<e.length;)r=W[e.charAt(a++)]<<18|W[e.charAt(a++)]<<12|(o=W[e.charAt(a++)])<<6|(n=W[e.charAt(a++)]),t+=64===o?Z(r>>16&255):64===n?Z(r>>16&255,r>>8&255):Z(r>>16&255,r>>8&255,255&r);return t},ep=H?e=>q(Buffer.from(e,"base64")):e=>q(eu(e).split("").map(e=>e.charCodeAt(0))),em=e=>ep(eh(e)),ef=H?e=>Buffer.from(e,"base64").toString("utf8"):z?e=>z.decode(ep(e)):e=>ed(eu(e)),eh=e=>X(e.replace(/[-_]/g,e=>"-"==e?"+":"/")),eE=e=>ef(eh(e)),ey=e=>({value:e,enumerable:!1,writable:!0,configurable:!0}),ew={encode:es,decode:eE},eS={encode:function(e,r={}){let{urlSafe:t=!1}=r;return ew.encode(e,t)},decode:ew.decode},eg="The provided `clientToken`",eT=`${eg} has expired`,eR=`${eg} is malformed`,ev=(e,r,t)=>({"primer-client-token":e,"primer-sdk-client":"WEB","primer-sdk-version":"v2.57.3","primer-sdk-checkout-session-id":r,...t&&{"x-api-version":t}});async function eN(e,r,t){let{accessToken:o,configurationUrl:n,analyticsUrlV2:a}=function(e){let r=function(e){try{let[r,t]=e.split(".");return JSON.parse(eS.decode(t||r))}catch{throw Error(eR)}}(e),t=1e3*r.exp;if(Date.now()>t)throw Error(`${eT}. Expiration date: ${new Date(t).toISOString()}`);return r}(e),i=P({checkoutSessionId:r,url:a}),s=l;i.timerStart({id:"CONFIGURATION_LOADING"});try{let{data:e,source:a}=await G(`${n}/?withDisplayMetadata=true`,{checkoutSessionId:r,headers:ev(o,r,s),retryConfig:{enabled:!0},cacheConfig:t});return i.timerEnd({id:"CONFIGURATION_LOADING",context:{source:a}}),e}catch(r){let e=r instanceof Error?r.message:"Unknown error occurred";throw Error(`Failed to initialize client: ${e}`)}}function ek(e){return e instanceof Error?{errorBody:e.message,stacktrace:e.stack}:"object"==typeof e&&null!==e&&"message"in e?{errorBody:String(e.message),stacktrace:"stack"in e?String(e.stack):void 0}:{errorBody:String(e||"Unknown error")}}function eA({checkoutSessionId:e,analytics:r,error:t,reporter:o}){r?.crashEvent?r.crashEvent({...ek(t),reporter:o}):e&&e_(e,t,o)}async function e_(e,r,t){let o=await v(S.CRASH_EVENT,{...ek(r),reporter:t},{checkoutSessionId:e});try{await fetch(u,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})}catch(e){console.error("Failed to post crash event",e)}}let eb=Symbol.for("initGlobalErrorMonitoringLoaded"),eI=(e,r)=>{"undefined"!=typeof window&&window[eb]||(window[eb]=!0,window.addEventListener("error",t=>{!eC(t)&&eO(t)&&eA({checkoutSessionId:e,analytics:r,error:t.error,reporter:"window.onerror"})}),window.addEventListener("unhandledrejection",t=>{let o=t.reason||Error("Unhandled promise rejection");eP(o)&&eA({checkoutSessionId:e,analytics:r,error:o,reporter:"unhandledrejection"})}))},eC=e=>"Script error."===e.message||!e.filename||0===e.lineno,eO=e=>{let r=e.filename;return!!(r&&eD(r))&&!!new d(e.error).isReported},eP=e=>{if(e&&"object"==typeof e&&"stack"in e&&"string"==typeof e.stack){let r=d.from(e);return!r.isReported&&(!!("fileName"in e&&"string"==typeof e.fileName&&eD(e.fileName))||eU(r.stack).some(eD))}return!1},eD=e=>{try{return new URL(e,window.location.origin).hostname.endsWith(".primer.io")}catch{return!1}},eU=e=>{if(!e)return[];let r=e.split("\n"),t=[],o=/^\s*at\s+(?:.*?\s+)?\(?(.+?):\d+:\d+\)?$/;for(let e of r){let r=e.match(o);if(r&&r[1])t.push(r[1]);else{let r=/@(.*?):\d+:\d+$/,o=e.match(r);o&&o[1]&&t.push(o[1])}}return t},ex=["https://sdk.primer.io/web/","https://sdk.dev.primer.io/web/","https://sdk.sandbox.primer.io/web/","https://sdk.production.primer.io/web/","https://assets.primer.io/","https://x.klarnacdn.net/kp/lib/v","https://www.paypal.com/sdk/js","https://www.paypalobjects.com/","https://js.stripe.com/","https://pay.google.com/gp/p/js/"];function eV(e,r,t){return document.querySelector(`${e}[${r}^="${t}"]`)}async function eM(e,r,t,o,n,a){let{analytics:i,name:s=r,retryConfig:c}=a;await V(()=>new Promise((a,c)=>{var l;let d,u=eV(e,t,r)||(l={...o,[t]:r},d=document.createElement(e),Object.entries(l).forEach(([e,r])=>d.setAttribute(e,r)),d);u.onload=()=>{i?.sdkFunctionEvent({name:s,params:[`${e.charAt(0).toUpperCase()+e.slice(1)} loaded successfully: ${r}`]}),a()},u.onerror=()=>{u.remove(),c(Error(`${n}: ${r}`))},u.parentNode||document.head.appendChild(u)}),c,e=>i?.messageEvent({...e,url:r}))}async function e$(r){return e||(e=Promise.all([function(e,r={}){if(!ex.some(r=>e.startsWith(r))){let t=`Script source not authorized per PCI DSS 6.4.3: ${e}`;return r.analytics?.scriptUnauthorizedEvent({scriptSource:e,errorMessage:t,severity:"ERROR"}),console.error(`[Primer SDK Security] ${t}`),Promise.reject(Error(t))}return eV("script","src",e)&&window.__Primer?(r.analytics?.sdkFunctionEvent({name:r.name??e,params:["Script already loaded"]}),Promise.resolve()):eM("script",e,"src",{...r.attributes,async:"",crossorigin:"anonymous"},"Can't load Primer SDK",r)}("https://sdk.primer.io/web/v2.57.3/PrimerCoreSDK.min.js",{analytics:r,name:"loadPrimerScript"}),function(e,r={}){return Array.from(document.styleSheets).some(r=>r.href===e)?(r.analytics?.sdkFunctionEvent({name:r.name??e,params:["Stylesheet already loaded"]}),Promise.resolve()):eM("link",e,"href",{...r.attributes,rel:"stylesheet"},"Can't load Primer SDK's Stylesheet",r)}("https://sdk.primer.io/web/v2.57.3/Checkout.css",{analytics:r,name:"loadPrimerCss"})]).then(()=>{let e=window.__Primer;return delete window.__Primer,e}).catch(r=>{throw e=void 0,r}))}let eF=async()=>{let e=a();try{let r=D(e);try{eI(e,r),r.sdkFunctionEvent({name:"preloadPrimer"}),r.timerStart({id:f.preloadPrimer}),await e$(r),r.timerEnd({id:f.preloadPrimer})}catch(o){let t=d.from(o);throw t.isReported||(eA({checkoutSessionId:e,analytics:r,error:t,reporter:"preloadPrimer level 1"}),t.markAsReported()),t}}catch(t){let r=d.from(t);throw r.isReported||(e_(e,r,"preloadPrimer level 0"),r.markAsReported()),r}},eL="v2.57.3",ej=eH("createHeadless"),eB=eH("showUniversalCheckout"),eG=eH("showVaultManager");function eH(e){return async(...[r,t,...o])=>{l=t?.apiVersion??"2.4";let n=a();try{let a=D(n);try{eI(n,a),a.sdkFunctionEvent({name:e,params:[r,t,...o]}),a.timerStart({id:f[e]});let[i,s]=await Promise.all([eN(r,n,t?.clientSessionCachingEnabled?{key:r,usePrimerSessionCacheTtlHeader:!0}:void 0),e$(a)]);return s[e](i,n,r,t,...o)}catch(r){let e=d.from(r);throw e.isReported||(eA({checkoutSessionId:n,analytics:a,error:e,reporter:"lazyLoad level 1"}),e.markAsReported()),e}}catch(r){let e=d.from(r);throw e.isReported||(e_(n,e,"lazyLoad level 0"),e.markAsReported()),e}}}window.Primer=n})();
//# sourceMappingURL=Primer.min.js.map